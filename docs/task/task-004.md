# Task-004: イベント取得 API 実装 (Backend)

**優先度**: 🟡 高  
**所要時間**: 1 日  
**担当**: バックエンド担当者

## 実行指示

### 必須作業標準

1. **詳細コメント**: AWS/Go 初心者でも理解できるよう、全コードに説明コメントを追加
2. **作業ログ記録**: `docs/log/task-004.md` に以下を詳細記録
   - 実行コマンド（再現可能な形で）
   - 発生したエラーと解決方法
   - 作成・修正したファイル一覧
   - 動作確認結果
   - 次タスクへの引き継ぎ事項
   - 学習ポイント・気づき

## 目的

イベント一覧取得・詳細取得機能を**効率的かつスケーラブルに**実装する。

## 成果物

- [ ] イベント一覧取得 Lambda
- [ ] イベント詳細取得 Lambda

## 詳細作業

### 1. IaC 更新

- `GET /events` エンドポイント追加
- `GET /events/{eventId}` エンドポイント追加

### 2. DynamoDB 設計・操作拡張

- **⚠️ 重要:** パフォーマンスとコストのため、一覧取得に`Scan`操作は**原則禁止**とします。`Query`操作による効率的な一覧取得を前提とし、必要であれば GSI (グローバルセカンダリインデックス)の設計・追加を IaC 担当者と連携して行います。

### 3. カーソルベース・ページネーションの実装 (Go)

- `GET /events` API は、クエリパラメータとして`limit`（取得件数）と`exclusiveStartKey`（前回の最後の項目のキー）を受け取れるようにする。
- DynamoDB の`Query`操作を実行し、結果と共に返される`LastEvaluatedKey`を取得する。
- API のレスポンスには、イベントデータの一覧と、次のページを取得するためのキーとしてこの`LastEvaluatedKey`（例: `nextToken`）を含める。

```json
// APIレスポンスの例
{
  "items": [
    /* ...イベントデータ... */
  ],
  "nextToken": "xxxx-yyyy-zzzz" // DynamoDBのLastEvaluatedKeyをエンコードしたもの
}
```

- `nextToken`が`null`の場合、それが最終ページであることを示す。

## 受け入れ条件

- [ ] `GET /events` API に`limit`を指定すると、その件数分だけイベントが返される。
- [ ] レスポンスに含まれる`nextToken`を次回の`exclusiveStartKey`としてリクエストすると、**続きのデータ**が取得できる。
- [ ] 最終ページまで到達すると、レスポンスの`nextToken`が`null`になる。
- [ ] 存在しない ID で`GET /events/{eventId}`を叩くと 404 エラーが返る。

## 前のタスク

[Task-003: イベント作成 API 実装](./task-003.md)

## 次のタスク

[Task-005: 認証基盤構築](./task-005.md)
